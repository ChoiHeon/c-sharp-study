# 동작 원리

일반적으로 Visual Studio를 설치하면 .NET Framework가 설치되고, .NET Framework를 설치하면 **CLR(Common Language Runtime)**이라는 일종의 가상 머신이 설치됩니다. 그리고 CLR은 C# 코드를 실행하는 역할을 합니다. C# 뿐만 아니라 CLS(.NET Framework)를 지키는 언어라면 CLR에서 동작이 가능합니다.

C#을 컴파일하면 **CIL(Common Intermediate Language /공통 중간 언어)**라는 바이트코드를 생성합니다. 이후 프로그램을 실행시키면 CLR이 바이트코드를 읽어서 OS가 이해할 수 있는 **Native Code로 변환**하게 됩니다.

위의 CIL가 CLR을 통해서 Native Code로 변환되는 일련의 과정을 **CLI(Common Language Infrastructure)**라고 합니다.

또한 닷넷 프레임워크 기반의 언어는 다양한 플랫폼에서도 닷넷 프레임워크가 설치되어 있다면 문제없이 실행할 수 있습니다. 이는 곧 확장성이 뛰어남을 의미합니다. 반면 C, C++ 보다 많은 과정을 거치기 때문에 속도에 대한 단점을 가지고 있습니다.

<br>

실행시 Visual Studio는 Just-In-Time Complie(적시 컴파일 / JIT 컴파일) 기반으로 실행됩니다. JIT 컴파일은 실행할 때마다 실시간으로 컴파일하여 실행한다는 의미입니다.

즉, CLR은 가상머신으로서 실행하고자 하는 환경에 최적화된 컴파일 코드를 만들고, Native Code를 생성하여 실행할 수 있도록 도와주는 역할을 한다고 할 수 있습니다.

만약 JIT 컴파일로 인한 CPU/메모리의 부담을 줄이고 어플리케이션의 시작 시간을 단축시키려면 NGen 같은 AOT 컴파일러를 사용해 CIL 코드를 미리 Native Code로 컴파일해둘 수 있습니다.

<br>

## Unity3D에서 C#을 사용하는 이유

Unity3D에서 보통 C#을 많이 사용하지만, 사실 JS, Boo 등 여러 언어로 개발이 가능합니다. 실제로도 C# 못지 않게 JS도 많이 사용되며 차이는 근소한 편입니다. 그럼에도 C#이 주로 사용되는 이유는 JS에서 사용하는 var 자료형의 실제 자료형을 유추하는데 시간이 다른 언어에 비해 오래 걸리는 편이며 객체지향 알고리즘에 더 최적화된 언어가 C#이기 때문입니다. 그리고 일부 기능은 C#으로만 가능한 경우도 있습니다. 

